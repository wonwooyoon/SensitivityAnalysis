SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE RICHARDS
    /
    SUBSURFACE_TRANSPORT transport
      MODE GIRT
    /
  /
END

SUBSURFACE

NUMERICAL_METHODS flow
  NEWTON_SOLVER
    ITOL_UPDATE 1.0d0
  /
  TIMESTEPPER
    INITIAL_TIMESTEP_SIZE 1e-5 yr
    MAXIMUM_TIMESTEP_SIZE 1e-3 yr    
  /
/

NUMERICAL_METHODS transport
  NEWTON_SOLVER
    STOL 1e-50
    ATOL 1e-50
    RTOL 1e-8
    MAXIMUM_NUMBER_OF_ITERATIONS 50
  /
  TIMESTEPPER
    INITIAL_TIMESTEP_SIZE 1e-6 yr
    MAXIMUM_TIMESTEP_SIZE 1e-4 yr
    MAXIMUM_TIMESTEP_SIZE 1e-3 yr at 0.01 yr
  /
/

CHEMISTRY

  ACTIVITY_COEFFICIENTS LAG TIMESTEP

  PRIMARY_SPECIES
    H+
    Ca++
    Na+
    K+
    Mg++
    CO3--
    Cl-
    UO2++
    O2(aq)
    H4(SiO4)
    Fe++
    Al+++
    SO4--
  /
  SECONDARY_SPECIES
    OH-
    CH4
    Al(OH)4-
    Al(OH)3
    NaAl(OH)4
    Al(OH)2+
    HCO3-
    CO2 
    Na(HCO3)
    Mg(HCO3)+
    CaCO3
    Na(CO3)-
    FeCO3
    Fe(OH)CO3
    Ca(SO4)
    Ca(HCO3)+
    MgCl+
    Fe+++
    FeCl+
    Fe(SO4)
    Fe(OH)+
    Fe(OH)2+
    Fe(OH)3
    Fe(CO3)2--
    H2(aq)
    Mg(SO4)
    Mg(CO3)
    U++++
    Ca2UO2(CO3)3
    CaUO2(CO3)3--
    UO2(CO3)3----
    MgUO2(CO3)3--
    Mg2UO2(CO3)3
    UO2(CO3)2--
    UO2(CO3)
    UO2(OH)+
    UO2(OH)2
    U(OH)4
    UO2+
    HS-
    H2S
    Fe(HS)+
    SO3--
    S2O3--
    Na(S2O3)-
    Mg(S2O3)
    Ca(S2O3)
    H(SO3)-
    H(SO4)-
  /
  
  PASSIVE_GAS_SPECIES
    O2(g)
  /
  
  MINERALS
    Smectite_MX80
    Quartz
    Gypsum
    Pyrite
    Calcite
    Dolomite
    Siderite
    Uraninite
  /

  ! Kinetics data from Palandri and Kharaka (2004) and Marty et al. (2015)
    
    MINERAL_KINETICS
    
    Smectite_MX80
      RATE_CONSTANT		0.0 mol/m^2-sec
    /
    
    Quartz
      SURFACE_AREA_VOL_FRAC_POWER 0.66667
      PREFACTOR
        RATE_CONSTANT		-13.99
	ACTIVATION_ENERGY	87.6d3
      /
    /
    
    Gypsum
      SURFACE_AREA_VOL_FRAC_POWER 0.6667
      PREFACTOR
        RATE_CONSTANT 		-2.79d0
	ACTIVATION_ENERGY 	0.00
      /
    /   
    
    Calcite
      RATE_CONSTANT		1.d-6 mol/m^2-sec
    /
    
    Pyrite
      SURFACE_AREA_VOL_FRAC_POWER 0.66667
      PREFACTOR
        RATE_CONSTANT 		-6.1135
        ACTIVATION_ENERGY 	62.0d3
	PREFACTOR_SPECIES 	H+
	  ALPHA 		-0.25
	/
	PREFACTOR_SPECIES 	Fe+++
	  ALPHA 		0.5
        /
      /
      PREFACTOR
        RATE_CONSTANT 		-8.431798
	ACTIVATION_ENERGY 	57.0d3
	PREFACTOR_SPECIES 	H+
	  ALPHA 		-0.18
	/
	PREFACTOR_SPECIES	O2(aq)
	  ALPHA			0.5
	/
      /
    /
        
    Dolomite
      SURFACE_AREA_VOL_FRAC_POWER 0.66667
      PREFACTOR
        RATE_CONSTANT		-3.553
	ACTIVATION_ENERGY	46d3
	PREFACTOR_SPECIES	H+
	  ALPHA			0.61
	/
      /
      PREFACTOR
        RATE_CONSTANT		-7.959
	ACTIVATION_ENERGY	31d3
      /
    /
        
    Siderite
      SURFACE_AREA_VOL_FRAC_POWER 0.66667
      PREFACTOR
        RATE_CONSTANT		-5.23
	ACTIVATION_ENERGY	56.0d3
	PREFACTOR_SPECIES	H+
	  ALPHA			0.6
	/
      /
      PREFACTOR
        RATE_CONSTANT		-8.68
	ACTIVATION_ENERGY	56.0d3
      /
    /
       
    Uraninite
      SURFACE_AREA_VOL_FRAC_POWER 0.66667
      PREFACTOR
        RATE_CONSTANT		-7.98
	ACTIVATION_ENERGY	32d3
      /
    / 
    
  /
  
  SORPTION
    ION_EXCHANGE_RXN
      MINERAL Smectite_MX80
      CEC 2.3925d3 ! unit: eq/m^3 of specified mineral 
      CATIONS
        Na+ 1. REFERENCE
        K+ 3.9810717
	Ca++ 2.5703957
        Mg++ 2.18776
	UO2++ 2.8183829
      /
    /
  
    SURFACE_COMPLEXATION_RXN
      EQUILIBRIUM
      MINERAL Smectite_MX80
      SITE >SOH 5.50 ! unit: mol/m^3 of specified mineral
      COMPLEXES
        >SOH2+
        >SO-
        >SOUO2+
        >SOUO2OH
        >SOUO2(OH)2-
        >SOUO2(OH)3--
        >SOUO2CO3-
        >SOUO2(CO3)2---
      /
    /

    SURFACE_COMPLEXATION_RXN
      EQUILIBRIUM
      MINERAL Smectite_MX80
      SITE >WOH 1.11d2 ! unit: mol/m^3 of specified mineral
      COMPLEXES
        >WOH2+
        >WO-
        >WOUO2+
        >WOUO2OH
        >WOUO2CO3-
      /
    /
  
    SURFACE_COMPLEXATION_RXN
      EQUILIBRIUM
      MINERAL Smectite_MX80 
      SITE >MOH 1.11d2 ! unit: mol/m^3 of specified mineral
      COMPLEXES
        >MOH2+
        >MO-
      /
    /
  /
  
  DATABASE ./PFLOTRAN_O2_ThermoChimie_v12a.dat
  
  LOG_FORMULATION
  UPDATE_MINERAL_SURFACE_AREA
  UPDATE_POROSITY
  UPDATE_PERMEABILITY
  
  OUTPUT
    TOTAL
    PE
    PRIMARY_SPECIES
    SECONDARY_SPECIES
    TOTAL_SORBED
    MINERALS
    MINERAL_VOLUME_FRACTION
    MINERAL_RATE
  /
  
END

GRID
  TYPE UNSTRUCTURED ML_sensitivity_analysis_new.h5
END

FLUID_PROPERTY
  DIFFUSION_COEFFICIENT 1.d-9 
END

MATERIAL_PROPERTY source
  ID 3
  POROSITY 0.01
  TORTUOSITY 1.0
  LONGITUDINAL_DISPERSIVITY 1
  PERMEABILITY
    PERM_ISO 1.d-20 ! unit: m^2
  /
  CHARACTERISTIC_CURVES default
END

MATERIAL_PROPERTY bentonite
  ID 2
   POROSITY 0.46550506501516586
  TORTUOSITY 1.0
  LONGITUDINAL_DISPERSIVITY 1
  PERMEABILITY
    PERM_ISO 1.d-19 ! unit: m^2
  /
  CHARACTERISTIC_CURVES default
END

MATERIAL_PROPERTY granite_fracture
  ID 1
  POROSITY 0.01
  TORTUOSITY 1.0
  LONGITUDINAL_DISPERSIVITY 1
  PERMEABILITY
    PERM_ISO 3.51160465621999e-15 ! unit: m^2
  /
  CHARACTERISTIC_CURVES default
END

CHARACTERISTIC_CURVES default
  DEFAULT
END

OUTPUT
  PERIODIC TIME 0.5 yr
  FORMAT TECPLOT BLOCK
END

TIME
  FINAL_TIME 1 yr
END

REGION all
  COORDINATES
    -50.d0 -50.d0 -1.d0
    50.d0 50.d0 1.d0
  /
END

REGION west
  FILE sideset1.ss
END

REGION east
  FILE sideset2.ss
END

REGION source 
  FILE material_3.txt
END

REGION bentonite
  FILE material_2.txt
END

REGION granite_fracture
  FILE material_1.txt
END

FLOW_CONDITION initial_pressure
  TYPE
    LIQUID_PRESSURE DIRICHLET
  /
  LIQUID_PRESSURE 501325.d0 ! unit: Pa
END

FLOW_CONDITION inlet_pressure
  TYPE
    LIQUID_PRESSURE DIRICHLET
  /
    LIQUID_PRESSURE 503400.1238980103 ! unit: Pa
END

TRANSPORT_CONDITION GRANITE_TC
  TYPE DIRICHLET_ZERO_GRADIENT
  CONSTRAINT_LIST
    0.d0 granite_conc
    ! 0.d0 bentonite_conc
  /
END

TRANSPORT_CONDITION BENTONITE_TC
  TYPE DIRICHLET_ZERO_GRADIENT
  CONSTRAINT_LIST
    0.d0 bentonite_conc
  /
END

TRANSPORT_CONDITION SOURCE_TC
  TYPE DIRICHLET_ZERO_GRADIENT
  CONSTRAINT_LIST
    0.d0 source_conc
  /
END

TRANSPORT_CONDITION INLET_TC
  TYPE DIRICHLET
  TIME_UNITS yr
  CONSTRAINT_LIST
    0.d0 seawater_conc
   6607.265091545468 granite_conc
  /
END

INITIAL_CONDITION GRANITE
  FLOW_CONDITION initial_pressure
  TRANSPORT_CONDITION GRANITE_TC 
  REGION granite_fracture
END

INITIAL_CONDITION BENTONITE
  FLOW_CONDITION initial_pressure
  TRANSPORT_CONDITION BENTONITE_TC
  REGION bentonite
END

INITIAL_CONDITION SOURCE
  FLOW_CONDITION initial_pressure
  TRANSPORT_CONDITION SOURCE_TC
  REGION source
END

BOUNDARY_CONDITION OUTLET
  FLOW_CONDITION initial_pressure
  TRANSPORT_CONDITION GRANITE_TC
  REGION east
END

BOUNDARY_CONDITION INLET
  FLOW_CONDITION inlet_pressure
  TRANSPORT_CONDITION INLET_TC
  REGION west
END

! Constraints are pre-calculated by PHREEQC to achieve semi-equilibrium state
CONSTRAINT granite_conc
  CONCENTRATIONS
    H+		6.852051282401e+00	pH
    CO3--	1.928352164749e-03	T
    Ca++ 	2.107152236567e-02	T
    Cl-		1.349976444646e-01	Z
    Fe++	3.299291132200e-05	M Pyrite
    K+		8.724101679132e-04	T
    Mg++	9.272473759514e-03	T
    Na+		8.853716903119e-02	T
    SO4--	6.779855055110e-03	T
    H4(SiO4)	1.801808365217e-04	M Quartz
    Al+++	1e-16			T
    UO2++	1e-16			T
    O2(aq)	-2.470793675101e+00	PE
  /
  MINERALS
    Smectite_MX80 	0.0	1e2 	m^2/m^3
    Quartz		0.25	0.05 	m^2/g
    Gypsum		0.0	1e2 	m^2/m^3
    Pyrite		0.0	1e2 	m^2/m^3
    Calcite		0.0	1e2 	m^2/m^3
    Dolomite		0.0	1e2 	m^2/m^3
    Siderite		0.0	1e2 	m^2/m^3
    Uraninite		0.0	1e2 	m^2/m^3
  /
/
  
CONSTRAINT bentonite_conc
  CONCENTRATIONS
    H+		6.945268024252		pH
    CO3--	0.00192578242528 	T
    Ca++ 	0.01538258848783	T
    Cl-		0.1348177453873		T
    Fe++	0.00003294893159619	M Pyrite 
    K+		0.001285364088667	T
    Mg++	0.006954515322063	T
    Na+		0.1777460955495		T
    SO4--	0.04367487872532	M Gypsum
    H4(SiO4)	0.0001796216086984	T
    Al+++	1e-16			T
    UO2++	1e-16			T
    O2(aq)	-2.490817602297		PE
  /
  MINERALS
    Smectite_MX80 	0.4650105934368057	8.5 	m^2/g
    Quartz		0.026724746749241707	0.05 	m^2/g
    Gypsum		0.003741464544893839	0.05 	m^2/g
    Pyrite		0.00012384020915417015	0.05 	m^2/g
    Calcite		0.0	1e2 	m^2/m^3
    Dolomite		0.0	1e2 	m^2/m^3
    Siderite		0.0	1e2 	m^2/m^3
    Uraninite		0.0	1e2 	m^2/m^3
  /
/	

CONSTRAINT source_conc
  CONCENTRATIONS
    H+		6.945268024252		pH
    CO3--	0.00192578242528 	T
    Ca++ 	0.01538258848783	T
    Cl-		0.1348177453873		T
    Fe++	0.00003294893159619	M Pyrite 
    K+		0.001285364088667	T
    Mg++	0.006954515322063	T
    Na+		0.1777460955495		T
    SO4--	0.04367487872532	M Gypsum
    H4(SiO4)	0.0001796216086984	T
    Al+++	1e-16			T
    UO2++	1e-16			T
    O2(aq)	-2.490817602297		PE
  /
  MINERALS
    Smectite_MX80 	0.0	0.0 	m^2/m^3
    Quartz		0.0	0.0 	m^2/m^3	
    Gypsum		0.0	0.0 	m^2/m^3
    Pyrite		0.0	0.0 	m^2/m^3
    Calcite		0.0	0.0 	m^2/m^3
    Dolomite		0.0	0.0 	m^2/m^3
    Siderite		0.0	0.0 	m^2/m^3
    Uraninite		0.05	1e2 	m^2/m^3
  /
/

CONSTRAINT seawater_conc
  CONCENTRATIONS
H+ 7.091716602284685 pH
O2(aq) 13.541936860753893 PE
Al+++ 1.000006890556487e-16 T
CO3-- 0.0019736382555451 T
Ca++ 0.0154125207720798 T
Cl- 0.3642211254878899 Z
Fe++ 2.6526593617663247e-05 T
H4(SiO4) 0.0001814533647483 T
K+ 0.0060451001084 T
Mg++ 0.0334533856926022 T
Na+ 0.2997217089325091 T
SO4-- 0.0187487104115532 T
UO2++ 1.0000974571648207e-16 T
  /
/
  
STRATA
  FILE ML_sensitivity_analysis_new.h5
END
